# Настройка тестовой системы для подключения к базе данных

## Проблема

Тестовая система не может подключиться к базе данных `distcomp` для выполнения SQL запросов.
Ошибка: "пароль пользователя "postgres" не может быть проверен (нет доступа)"

## Текущие настройки базы данных

✅ База данных `distcomp` существует  
✅ Схема `distcomp` создана  
✅ Все таблицы созданы  
✅ Подключение работает с паролем `1902`

## Настройка тестовой системы

Тестовая система должна использовать следующие параметры подключения:

### Параметры подключения:

```
JDBC URL: jdbc:postgresql://localhost:5432/distcomp
Username: postgres
Password: 1902
Schema: distcomp (опционально)
```

## Возможные решения

### Решение 1: Изменить пароль PostgreSQL на дефолтный

Если тестовая система использует дефолтный пароль `postgres`, можно временно изменить пароль:

```sql
-- Подключиться к PostgreSQL
psql -U postgres

-- Изменить пароль
ALTER USER postgres WITH PASSWORD 'postgres';
```

**ВНИМАНИЕ:** После этого нужно также изменить пароль в `application.properties` на `postgres`.

### Решение 2: Настроить тестовую систему на использование пароля 1902

Найдите конфигурационный файл тестовой системы и установите:
- Password: `1902`

### Решение 3: Создать отдельного пользователя для тестов

```sql
-- Создать пользователя для тестов
CREATE USER testuser WITH PASSWORD '1902';

-- Дать права на базу данных
GRANT ALL PRIVILEGES ON DATABASE distcomp TO testuser;

-- Дать права на схему
\c distcomp
GRANT ALL ON SCHEMA distcomp TO testuser;
GRANT ALL PRIVILEGES ON ALL TABLES IN SCHEMA distcomp TO testuser;
ALTER DEFAULT PRIVILEGES IN SCHEMA distcomp GRANT ALL ON TABLES TO testuser;
```

Затем в тестовой системе использовать:
- Username: `testuser`
- Password: `1902`

### Решение 4: Проверить pg_hba.conf

Если проблема в настройках аутентификации PostgreSQL, проверьте файл `pg_hba.conf`:

1. Найдите файл (обычно в `C:\Program Files\PostgreSQL\18\data\pg_hba.conf`)
2. Убедитесь, что есть строка для localhost:
   ```
   host    all             all             127.0.0.1/32            md5
   ```
3. Перезапустите PostgreSQL после изменений

## Проверка подключения

Для проверки, что подключение работает, выполните:

```powershell
$env:PGPASSWORD='1902'
psql -U postgres -d distcomp -c "SELECT COUNT(*) FROM distcomp.tbl_user;"
```

Если команда выполняется успешно, значит подключение работает правильно.

## Важно

REST API приложения работает корректно - все HTTP запросы проходят успешно.
Проблема только с прямыми SQL запросами тестовой системы к базе данных.

Если тестовая система - это внешний инструмент, который вы не можете настроить,
возможно, нужно связаться с администратором тестовой системы для настройки параметров подключения.

